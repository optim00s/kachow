<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Kachow</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="popup.css" />
</head>
<body>
  <div class="bg-grid"></div>
  <div class="glow glow-1"></div>
  <div class="glow glow-2"></div>
  
  <div id="root">
    <header>
      <div class="logo">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 2v11h3v9l7-12h-4l4-8H7z" fill="url(#bolt-gradient)"/>
          <defs>
            <linearGradient id="bolt-gradient" x1="7" y1="2" x2="17" y2="22" gradientUnits="userSpaceOnUse">
              <stop stop-color="#00ff87"/>
              <stop offset="1" stop-color="#60efff"/>
            </linearGradient>
          </defs>
        </svg>
        <h1>Kachow</h1>
      </div>
      <div class="header-actions">
        <button class="compact-toggle" id="compactToggle" title="Toggle compact mode">
          <svg class="icon-expand" width="14" height="14" viewBox="0 0 24 24" fill="none">
            <path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <svg class="icon-compact" width="14" height="14" viewBox="0 0 24 24" fill="none">
            <path d="M4 14h6v6M20 10h-6V4M14 10l7-7M3 21l7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <span class="badge" id="statusBadge">
          <span class="pulse"></span>
          <span id="statusText">Detecting…</span>
        </span>
      </div>
    </header>

    <div class="battery-ring-container">
      <svg class="battery-ring" viewBox="0 0 120 120">
        <defs>
          <linearGradient id="ring-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#00ff87"/>
            <stop offset="50%" stop-color="#60efff"/>
            <stop offset="100%" stop-color="#0061ff"/>
          </linearGradient>
        </defs>
        <circle class="ring-bg" cx="60" cy="60" r="52" />
        <circle class="ring-progress" id="ringProgress" cx="60" cy="60" r="52" />
      </svg>
      <div class="battery-center">
        <span class="battery-percent" id="level">--</span>
        <span class="battery-label">%</span>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon power-icon">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="stat-content">
          <span class="stat-value" id="power">--</span>
          <span class="stat-label">Power Draw</span>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon time-icon">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="stat-content">
          <span class="stat-value" id="timeInfo">--</span>
          <span class="stat-label" id="timeLabel">Remaining</span>
        </div>
      </div>
    </div>

    <!-- Session & Averages Stats -->
    <div class="extended-stats">
      <div class="extended-stat">
        <span class="extended-label">Session</span>
        <span class="extended-value" id="sessionEnergy">0.00 Wh</span>
      </div>
      <div class="extended-stat">
        <span class="extended-label">5m Avg</span>
        <span class="extended-value" id="avg5m">-- W</span>
      </div>
      <div class="extended-stat">
        <span class="extended-label">30m Avg</span>
        <span class="extended-value" id="avg30m">-- W</span>
      </div>
      <div class="extended-stat">
        <span class="extended-label">1h Avg</span>
        <span class="extended-value" id="avg1h">-- W</span>
      </div>
    </div>

    <!-- Power Profile Badge -->
    <div class="power-profile" id="powerProfile">
      <div class="profile-icon">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
          <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <span class="profile-text" id="profileText">Detecting...</span>
    </div>

    <div class="chart-container">
      <div class="chart-header">
        <span class="chart-title">Power History</span>
        <div class="chart-actions">
          <span class="chart-value" id="chartValue">-- W</span>
          <button class="export-btn" id="exportBtn" title="Export Chart as PNG">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
              <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      </div>
      <canvas id="powerChart" width="320" height="120"></canvas>
    </div>

    <footer>
      <span class="capacity-info">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
          <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        Estimates may vary · 37 Wh Battery
      </span>
    </footer>
  </div>

  <script src="popup.js"></script>
</body>
</html>
